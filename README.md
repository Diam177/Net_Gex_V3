# Streamlit Net GEX / AG / PZ / PZ_FP App (Polygon Yahoo Finance 15)

Одностраничное приложение без логина. Получает опционные данные из Polygon (Yahoo Finance 15),
считает метрики по вашим методологиям и визуализирует.

## Возможности
- Ввод тикера (SPY по умолчанию)
- Выбор даты экспирации (по умолчанию ближайшая будущая)
- Кнопка «Скачать сырой JSON» (ровно как от провайдера, без изменений)
- Таблица: Strike, Put OI, Call OI, Put Volume, Call Volume, Net Gex, AG, PZ, PZ_FP
- 8 переключателей слоёв и интерактивный график (левая ось — Net Gex, правая — остальные серии)

## Быстрый старт (локально)
1. Установите Python 3.10+
2. Установите зависимости:
   ```bash
   pip install -r requirements.txt
   ```
3. Укажите секреты Polygon:
   - Создайте файл `.streamlit/secrets.toml` и вставьте туда:
     ```toml
     POLYGON_API_KEY = "yahoo-finance15.p.rapidapi.com"
     POLYGON_API_KEY  = "ВАШ_КЛЮЧ"
     ```
   - (или) задайте переменные окружения `POLYGON_API_KEY` и `POLYGON_API_KEY`
4. Запустите:
   ```bash
   streamlit run app.py
   ```

## Деплой в Streamlit Cloud
- Залейте репозиторий на GitHub
- В настройках приложения добавьте Secrets (POLYGON_API_KEY, POLYGON_API_KEY)
- Команда запуска: `streamlit run app.py`

## Примечания
- В коде предусмотрен устойчивый выбор σ_ATM и заполнение IV при пропусках.
- PZ v2.2 и PZ_FP v3 считаются с учётом всех доступных серий и приводятся к сетке страйков выбранной экспирации.
- Если провайдер не вернул нужную экспирацию одним запросом, выполняется повторный запрос с параметром `date`.
- Если API недоступен, можно подать файл JSON через загрузчик в интерфейсе.
